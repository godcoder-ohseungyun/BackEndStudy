# 트랜스포트 계층(Transport Layer) 서비스

---

**[응용프로세스간 통신]**

Network -> transport -> application 



## 네트워크 계층 서비스(대표 프로토콜: IP )

**호스트(Host)간의 통신을 의미한다.**

> 인터넷 호스트간에 패킷(데이터그램) 전달
>
> 호스트의 인터넷 통신 장치 : NIC(Network 
> Interface Card)

**최선형(Best-effort) 서비스**

> 자원이 허락하는 범위내에서 최적의 통신 서비
> 스 제공
> 자원이 부족한 경우 지연시간 발생, 패킷 훼손/
> 손실 발생 가능: 비신뢰 서비스(unreliable service)

**비연결형(Connectionless) 서비스**

> 패킷 전달 경로가 다를 수 있음
> 패킷 도착 순서가 바뀔 수 있음

IP(**Internet Protocol**)

> IP 주소 기반의 패킷(데이터그램) 전달
> IP 주소 : 인터넷에 연결된 NIC(호스트) 구분



## 트랜스포트 계층 서비스(대표 프로토콜: TCP,UDP)

![image](https://user-images.githubusercontent.com/68331041/134859894-8df2f19b-7b43-4990-ba8f-89d8cabec86e.png)

+ IP영역 즉, **네트워크 계층 서비스를 포괄**하여 **NIC**(HOST장치)내 **Application**들과 데이터를 주고받는 것

**[기능]**

> ### **다중화**
>
> > **데이터를 패킷으로 나누어 네트워크 계층에게 전달**, 네트워크 계층은 패킷을 전송
> >
> > > **포트번호** 같은 **필요 정보를 포함**하여 **패키징**한다.\
>
> ### **역다중화**
>
> > **패킷**들을 **데이터로 재 조립**하여 **어플리케이션들에게 전달**
>
> **무결성(Integrity) 확인**
>
> > 손상 여부 확인
>
> **신뢰 전송(Reliable Transfer)**
>
> > **오류 복구**(Error Recovery) : 손상 또는 손실 세그먼트 복구
> > **흐름 제어**(Flow Control) : 수신 버퍼 오버플로어(overflow) 방지
>
> **혼잡 제어(Congestion Control)**
>
> > 전송량 조절을 통해 네트워크 혼잡 상황 회피 및 해소



**트랜스포트 계층 대표 프로토콜 TCP vs UDP**

![image](https://user-images.githubusercontent.com/68331041/134861168-f1f93f78-1753-4bdb-be48-bbcf8b9fdf33.png)

+ 대신 **UDP는 간결함으로 고속 통신**이 **가능**하다. 



### 정리

![image](https://user-images.githubusercontent.com/68331041/134861599-6aacd533-f586-4feb-9214-7003ecde031e.png)

IP(인터넷 프로토콜)을 가지고 인터넷 상에서 HOST(NIC)간에 통신을 **네트워크 계층 서비스**라고 하고 이를 **포괄**하여 HOST의 APPLICATION들과 통신하는것을 **트랜스포트 계층 서비스**라고한다.

이때 같은 프랜스포트 계층을 타고 넘어온 데이터를 **여러 APPLICATION**들이 사용해야한다면 다중화했던 **PORT**정보를 가지고 올바른 PORT에 수신한다.

![image](https://user-images.githubusercontent.com/68331041/134862289-297efeb3-2dcb-4153-92dd-a017e725763d.png)

APPLICATION에서 데이터를 전송할시 **트랜스포트 계층(TCP,UDP)에서 PORT정보와 데이터를 가공**하여 IP 즉, **네트워크 계층(IP)에 넘겨**주면 네트워크 계층이 송수신을 위한 가공을 하여 데이터를 **통신**한다.

가공과정을 **다중화** 가공된 데이터를 본연의 데이터로 분해하는것을 **역다중화** 라고 한다.



## 통신 유형(TCP와 UDP차이)

> ### 다중화 유형
>
> **연결형**(connection-oriented) : 통신 소켓간에 **1:1** 논리적 연결 설정
>
> > 프로토콜: TCP
> >
> > **연결된 소켓끼리만 통신**가능(**핸드셰이킹**)
> >
> > **UDP보다 안정성이 높음**
>
> **비연결형**(connectionless) : 통신 소켓간에 **1:N** 논리적 연결 설정
>
> > 프로토콜: UDP
> >
> > **소켓 연결 과정 없음**
> >
> > 연결되지 않아도 구분키를 통해 자유롭게 통신가능
> >
> > **TCP보다 빠름**



**[다중화 특징]**

+ 다중화란 데이터를 **패킷화** 하여 전송하는것
+ **데이터 송신**의 개념으로 이해하자
+ 수신은 역다중화

![image](https://user-images.githubusercontent.com/68331041/135252863-a2c8b25b-83ed-4e1c-b09f-aed7c2ff0582.png)

**서버**는 URL + **80 PORT**로 **잘 알려진 포트** 고정되어있다.

**클라이언트**는 그때그때 **일시적인 포트**를 사용한다.



+ **소켓**: 트랜스포트 계층이 제공하는 응용 프로세스 통신 통로 자료구조
+ **응용 프로세스 주소** : 소켓 주소(IP 주소 + 포트번호)



# UDP와 책섬

---

+ 트랜스포트 계층 대표 프로토콜 TCP와 UDP 중 **UDP**에서 **책섬 기술을 사용**한다.
+ 추후에 TCP서비스를 공부하면 비교하여 보자



## UDP서비스



**비연결형:::** TCP와 달리 통신이전에 **소켓간의 연결설정이 없다**. (**핸드 셰이킹** 과정이 없다.)

> 소켓간의 연결이 있어야만 통신할수있는 **TCP와 달리** **UDP는 독립적으로 통신**함으로
>
> **동시의 여러** 클라이언트가 서버와 **통신**하거나 그 반대도 가능하다. **N:1 / 1:N 통신**
>
> ### 멀티테스킹 통신에 사용됨



**빠르고 간결한 통신이 가능**

**서버는 고정된 포트를 사용함**으로  이런 서비스가 가능

응용 프로세스로부터 데이터가 **송신 소켓**에 전달되면, 송신 **UDP는 해당 데이터를 포함하는 UDP 데이터그램(Datagram) 생성** 각 데이터그램은 IP를 통해 **''독립적''으로 목적지 UDP 소켓에 전송**



### 작고 빠른 데이터가 요구되는 작업에서 사용된다.



![image](https://user-images.githubusercontent.com/68331041/135256202-7df27865-fb11-4d94-9186-31cd4bef6cf0.png)

+ TCP와 달리 **출발 포트 도착포트**와 무결성 조건을 검사하는 **첵섬 데이터**만 포함된다.

> **무결성 검사 책섬 :::** 데이터의 손상이나 잘못된게 없는지 검사한다.

+ **매우 간단한 양식**
+ **수신측**도 처리가 복잡하지 않아서 더 **빠른 응답 가능**



## 첵섬

+ 데이터 해싱
+ 메시지를 정해진 길이의 데이터 단위로 나눔
+ 보수 검사합을 이용해 무결성 검사

### 장점
>  **높은 오류 검출 능력**
>  단순함
>  **소프트웨어 구현에 적합**

### 단점

>  각 데이터 단위에서 발생하는 오류의 **합이 0이 되는 오류 검출 불가**
>  **첵섬을 변경하지 않는 오류 검출 불가**





