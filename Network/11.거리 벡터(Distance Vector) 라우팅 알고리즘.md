# 거리 벡터(Distance Vector) 라우팅 알고리즘

---

![image](https://user-images.githubusercontent.com/68331041/143811599-27dc6afc-6dd3-4238-aab1-1c8861fcff37.png)

인터넷을 가중치 그래프로 살펴보자.

각각의 라우터를 노드 라우터끼리 통신 경로를 간선이라고 할수있을것이다.

각 간선은 통신비용이 상이하기 때문에 가중치를 부여할수있을것이다.



### 라우팅

라우팅이란 출발라우터에서 목적지 네트워크의 라우터까지 도달하는 최소 비용경로를 찾는 것이다.

이 라우팅 과정엔 알고리즘이 사용된다.

<img src="https://user-images.githubusercontent.com/68331041/143811889-ec437014-7def-401d-8542-55030ff77c60.png" alt="image" style="zoom:50%;" />

> 라우팅은 HOB BY HOP으로 동작한다.
>
> 출발지 라우터에서 목적지 네트워크의 라우터까지 최소 비용 경로를 찾고, **최소 비용 경로상의 다음 라우터의 주소만 라우팅 테이블에 저장**
>
> > 모든 라우터 경로를 테이블에 유지하면 테이블 크기가 커지고 네트워크 성능저하로 이어진다.



### 거리백터

<img src="https://user-images.githubusercontent.com/68331041/143812588-4aa6a9ca-478f-46d6-8775-5c6dc597d9f9.png" alt="image" style="zoom:50%;" />

초기에 각 라우터(노드)는 직접 연결된 간선의 가중치를 배열의 형태로 유지하고있다.

하지만 **거리벡터공유**라는 것을통해 x[]의 배열을 u[]와 공유하여 정보를 갱신할수있다.

예를들어 u는 y와 직접 간선이 없기 때문에 무한값으로 가중치가 부여되어있지만

x와 배열을 공유함으로써 간선x-y의 가중치가 1이라는것을 알수있다.

u[]는 자신이 알고있는 간선u-x의 가중치가 1이라는 정보와 x[]의 간선x-y의 가중치가 1이라는것을 이용해

u[] 배열의 y의 가중치를 1+1=2로 갱신한다.

![image](https://user-images.githubusercontent.com/68331041/143812923-53353a87-1878-4e19-b37a-398877116425.png)

이웃 라우터들과의 거리벡터 데이터를 공유함으로써 자신의 거리벡터 데이터를 갱신한다는것이다.

> 벨먼-포드 방정식



**거리벡터 공유**에는 큰 문제가 있다. 

<img src="https://user-images.githubusercontent.com/68331041/143813259-fb43a698-0684-4b01-aeed-31d327f7dd65.png" alt="image" style="zoom:50%;" />

B는 A로부터 간선a-c가중치가 1임을 전달받고 B[] 의 c를 2로 갱신한다. 경유 노드(다음 라우터)를 A로 설정

이때 간선a-c가 고장이나서 가중치가 무한대가 되었다고 해보자

B는 자신의 갱신사항을 A에게 전달한다. 간선 b-c의 가중치가 2임

A는 또다른 간선 b-c가 존재한다고 생각하고 3으로 갱신하고 경유노드를 B로 설정한다.

이게 증가하며 무한히 반복되는 문제가 있다. 

**포이즌 리버스**

<img src="https://user-images.githubusercontent.com/68331041/143814047-477ef721-1618-4427-bd70-9fe59774be7e.png" alt="image" style="zoom:50%;" />

포이즌 리버스 방식으로 해결할수있다. B가 A로부터 거리벡터 데이터를 받아 갱신해 자신의 갱신사항을 A에게 다시 돌려줄때 갱신값이 아닌 무한값을 돌려주는것이다.

> A는 자신의 데이터로 B가 갱신된것이기때문에 B의 갱신데이터를 사용할 필요가 없기 때문

이렇게 하면  A는 B-C사이에 또다른 간선이 없다는걸 알고 데이터를 사용하지 않는다.



하지만 포이즌 리버스 방식으로는 순환 노드를 해결할수없다.

<img src="https://user-images.githubusercontent.com/68331041/143814495-7e0174b9-b99a-4650-8d42-208e58a7273a.png" alt="image" style="zoom:33%;" />



