## [머신러닝] 개요

---

### 기본 용어 정리

**GPU & CPU**

> GPU는 비디오, 즉 픽셀로 이루어진 영상을 처리하는 용도로 탄생
>
> CPU에 비해 반복적이고 비슷한, 대량의 연산을 수행하며 이를 병렬적으로(Parallel) 나누어 작업하기 때문에 CPU에 비해 속도가 대단히 빠르다. 영상, 렌더링을 비롯한 그래픽 작업의 경우 픽셀 하나하나에 대해 연산을 하기 때문에 연산능력이 비교적 떨어지는 CPU가 GPU로 데이터를 보내 재빠르게 처리한다.
>
> CPU 는 GPU 보다 더 적은 코어를 갖고 있지만 각각의 코어가 GPU 보다 더 강력한 컴퓨팅 파워를 갖고 있다. 따라서 CPU 는 **순차적인 작업 (Sequential task)** 에 더 강점이 있다. 반면 GPU 는 CPU 보다 코어수는 많지만 각각의 코어가 GPU 보다 더 성능이 낮기 때문에 **병렬적인 작업 (Paralell task)** 에 더 강점이있다.

**아나콘다(Anaconda)**

> 파이썬은 파이썬 공식 홈페이지에서 받을 수 있으며, pip 툴만을 포함하고 있다. 필요한 패키지나 라이브러리 등을 설치할 때 모두 수동으로 해줘야 한다. 그러나 아나콘다는 파이썬 기본 패키지에 각종 수학/과학 라이브러리들을 같이 패키징해서 배포하는 통합 개발 플랫폼이라고 볼 수 있다.
>
> 아나콘다에 포함된 툴들로는 대표적으로 panda, numpy, scipy, sklearn, matplotlib, Jupyter Notebook 등이 있다.
>
> 아나콘다를 사용하면 파이썬 버젼별로 가상환경을 만들수도있다.
>
> > 특정 라이브러리가 파이썬 버전에 종속되는 경우 문제 해결
> >
> > 목적에 따라 여러 개의 독립적인 개발환경을 구성하여 프로그램을 개발할 수 있다.

**텐서플로(Tensorflow)**

> **구글에서 공개한 머신러닝 라이브러리**
>
> > 라이브러리란? 
> >
> > 다른 사람이 쉽게 사용할수있도록 이미 완성되어있는 코드
>
> 머신러닝에 대한 깊은 지식이 있어야 짤수있는 코드를 미리 만들어 대중에게 제공함으로써
>
> **산업계에서 머신러닝을 활용할수있도록 함**
>
> > 유사한 라이브러리로 파이토치 등이 존재하지만 파이토치는 연구계에서 많이 쓰인다.
>
> **CPU만을** **지원하는** **버전**
>
> 만약 **NVIDIA의 GPU를 사용하고 있지 않을 경우** 반드시 CPU만 지원하는 버전으로 설치하셔야 합니다. GPU를 지원하는 텐서플로우 보다 설치하기 쉽다는 장점이 있어, 처음 텐서플로우를 설치하는 경우 CPU만 지원되는 버전을 추천합니다.
>
> **GPU를** **함께** **지원하는** **버전**
>
> NVIDIA GPU를 지원하는 버전의 경우 CPU에서 실행되는 버전보다 월등히 빠른 성능을 나타낸다. 따라서, 텐서플로우를 실행하기 위한 사양의 NVIDIA GPU를 갖고 계신 경우 GPU를 지원하는 버전으로 설치해야 보다 빠르게 처리 할 수 있습니다. CPU만 지원하는 텐서플로우 버전보다 성능차이가 크기 때문에 궁극적으로는 GPU를 지원하는 버전으로 사용하는 것이 좋습니다.

**케라스(Keras)**

> 케라스(Keras)는 파이썬으로 작성된 오픈 소스 신경망 라이브러리입니다. 
>
> > 텐서플로를 더 쉽게 사용하도록 만든 고수준 API
>
> 케라스는 딥러닝 비전문가라도 각자 분야에서 손쉽게 딥러닝 모델을 개발하고 활용할 수 있도록  직관적인 API를 제공하고 있습니다. **케라스는 텐서플로 위에서 동작하는 라이브러리** 입니다. 
>
> 처음 머신러닝, 딥러닝을 시작하고 매우 간단한 것을 제작하거나 빠른 시간 내에 프로토타이핑을 하고자 한다면 Keras가 훨씬 좋은 선택일 수 있습니다. 
>
> > 직관성이 떨어지고 진입 장벽이 높은 Tensorflow와는 달리 일반 **Python API 형태로 제공**하다보니 사용하기가 훨씬 쉽고 사용자 친화적인 환경을 제공하고 있습니다. 향후 **Python 표준 딥러닝 API 형태로 자리 잡을 가능성**이 있습니다.



### 개발 환경 설정

> 1. **아나콘다 설치**
>
> > [Anaconda | Individual Edition](https://www.anaconda.com/products/individual)
>
> 2. **Anaconda Prompt 실행**
>
> > ~~~
> > (base) C:\Users\사용자계정>python --version
> > ~~~
>
> 3. **pip 설치 및 최신화**
>
> > ~~~
> > (base) C:\Users\사용자계정>python –m pip install –-upgrade pip  
> > ~~~
> >
> > PIP는 Python Package Index (PyPI) 저장소로부터 패키지를 다운받아 설치 및 관리해주는 패키지 매니저
>
> 4.  **가상환경 만들기**
>
> > 프로젝트를 진행할때 여러 라이브러리,패키지 등을 사용할때 충돌문제 또는 특정 버전을 요구하는 경우가 발생한다.
> >
> > 각 프로젝트마다 "독립적인 작업 환경"을 만들어 독립적으로 프로젝트 작업 환경을 구축, 진행하게 할수있다. 
> >
> > ~~~python
> > #가상환경생성
> > conda create -n [가상환경이름] python=3.7 
> > # 가상환경이름 및 파이썬 버전 선택
> > # "c:\users\사용자계정\anaconda3\env\[가상환경이름]" 라는 디렉토리가 생성
> > 
> > #가상환경생성확인
> > conda env list
> > 
> > #가상환경활성화
> > activate [가상환경이름]
> > 
> > #가상환경비활성화
> > conda deactivate
> > ~~~
> >
> > > 가상환경별로 파이썬 버전을 다르게 관리할수있다.
> >
> > 5. **NVIDIA GPU환경 설정**
> >
> > > AMD GPU를 사용함으로 이부분은 건너뛴다.
> > >
> > > > **CPU만을** **지원하는** **버전** 사용
> >
> > 6. **텐서플로 설치**
> >
> > > ~~~
> > > (base)>activate [가상환경이름]
> > > ~~~
> > >
> > > 작업할 가상환경을 활성화 시킨 후 텐서플로 설치 진행
> > >
> > > ()부분이 base 기본에서 활성화한 가상환경으로 바뀔것이다.
> > >
> > > ~~~
> > > (가상환경이름)>python -m pip install --upgrade pip
> > > ~~~
> > >
> > > pip를 최신버전으로 업그레이드 해준다.
> > >
> > > ~~~python
> > > #CPU만 사용하는 버전
> > > (가상환경이름)>conda install tensorflow
> > > ~~~
> > >
> > > 텐서플로 설치
> >
> > 7. **케라스 설치**
> >
> > > ~~~
> > > (가상환경이름)>pip install keras
> > > ~~~
> > >
> > > 케라스 설치, Tensorflow 2.x 버전부터는 기본 포함
> > >
> > > ![image](https://user-images.githubusercontent.com/68331041/146889163-db96e7f3-c4b5-4000-ae79-ecfc5c69c667.png)
> >
> > 8. **주피터 노트북 설치**
> >
> > > 주피터 노트북이란 파이썬의 개발 지원 툴로 사용방법이 간편하며 시각화에 강해 데이터 분석에 주로 사용됩니다.
> > >
> > > ~~~python
> > > # 설치
> > > (가상환경이름)>pip install jupyter
> > > # 실행
> > > (가상환경이름)>jupyter notebook
> > > ~~~
> > >
> > > 위 명령을 입력하면 자동으로 어떤 html 파일을 열면서 브라우저가 실행됩니다. 만약 실행되지 않는다면 http://localhost:8888 으로 접속하거나 위 그림의 맨 마지막 줄에 있는 url을 복사하여 브라우저에서 접속합니다.
> >
> > 9. **vscode에서 사용하기**
> >
> > >  Python Extension Pack 설치: 파이썬 프로그래밍을 위해
> > >
> > > 터미널 gitbash로 변경
> > >
> > > (컨트롤 + 쉬프트 + P) 키를 눌러 Command Palette를 열고 Python: Select Interpreter 
> > >
> > > 지정한 가상환경이름 폴더내의 인터프리터를 지정
> > >
> > > 터미널에서 activate [가상환경이름] : 가상환경 활성화

### 필수 라이브러리

> 파이썬 라이브러리를 이용하여 머신러닝을 손쉽게 다룰수있다.
>
> **numpy:** 행렬이나 일반적으로 대규모 다차원 배열을 쉽게 처리할 수 있도록 지원하는 파이썬의 라이브러리
>
> **scipy:** 파이썬을 기반으로 하여 과학, 분석, 그리고 엔지니어링을 위한 과학(계산)적 컴퓨팅 영역의 여러 기본적인 작업을 위한 라이브러리
>
> > NumPy위에서 구동되는 라이브러리
> >
> > NumPy의 ndarray를 기본 자료형으로 사용
>
> **matplotlib:** 자료를 차트나 plot으로 데이터 시각화 
>
> **pandas:** 데이타 분석(Data Analysis)을 위해 널리 사용되는 파이썬 라이브러리 패키지



## Reference

---

[딥러닝 한권으로 배우기](https://sdc-james.gitbook.io/onebook/)





## [머신러닝]K-means

---

+ 군집화 알고리즘
+ 여러개의 데이터를 적절히 묶어서 나타내기 위한 목적으로 사용된다.



쉽게 말해 **데이터를 K개의 군집(Cluster)으로 묶는(Clusting) 알고리즘**이다.

K-means 알고리즘에서 K는 묶을 군집(클러스터)의 개수를 의미하고 means는 평균을 의미한다.

> 각 군집의 평균을 활용해 **K개의 군집으로 군집화**한다.
>
> 여기서 **평균은 각 클러스터의 중심과 데이터의 평균 거리를 의미**



K-means 알고리즘은 가깝게 위치하는 데이터를 비슷한 특성을 지닌 데이터로 여기고 같은 군집으로 군집화한다.

다음과 같은 데이터들이 주어졌을 때

<img src="https://user-images.githubusercontent.com/68331041/146630641-14319195-fbf4-4d08-9689-54d441cc9152.png" alt="image" style="zoom:25%;" />

아래와 같이 군집화 된다.

<img src="https://user-images.githubusercontent.com/68331041/146630649-81b635be-a60a-46b5-b025-765f4e23bc85.png" alt="image" style="zoom:25%;" />



### K-means 알고리즘 원리

~~~
1. 군집의 개수(K) 설정하기
2. 초기 중심점 설정
3. 데이터를 군집에 할당(배정)
4. 중심점 재설정(갱신)
5. 데이터를 군집에 재할당(배정)
6. 중심점 위치가 더 이상 변하지 않을때까지 4,5 과정 반복
~~~



#### step 1) 군집의 개수(K) 설정하기

데이터를 준비한 뒤 **몇 개의 군집으로 군집화할지**는 사람이 정해야한다. 

이는 K-means 알고리즘의 **한계점 중에 하나**로  군집의 개수 설정을 어떻게 하냐에 따라 결과가 크게 달라지며 터무니 없는 결과가 나올 수도 있다는 것이다. 

그래서 **군집의 개수를 설정하는 방법론**으로 다음과 같은 몇 가지 방법들이 존재한다.

1) Rule of thumb
2) Elbow Method
3) 정보 기준 접근법 (Information Criterion Approach)



#### step 2) 초기 중심점 설정하기

그 다음 **K개의 초기 중심점(Center of Cluster, Centroid)을 설정하는 단계**이다. 

k-means 알고리즘은 초기 중심점으로 어떤 값을 선택하는가에 따라 성능이 크게 달라지는 성질을 가지고 있다고 한다. 따라서 초기 중심 값을 잘 설정해야하며 다음과 같은 몇가지 방법들이 있다.

1) Randomly select
2) Manually assign
3) K-means++



#### step 3) 데이터를 군집에 할당(배정)하기

그 다음 거리 상 가장 가까운 군집(중심점)으로 주어진 모든 데이터를 할당 또는 배정한다.



#### step 4) 중심점 재설정(갱신)하기

모든 주어진 데이터의 군집 배정이 끝나면 군집의 중심점(Centroid)을 그 군집의 속하는 데이터들의 가장 중간(평균)에 위치한 지점으로 재설정한다.



#### step 5) 데이터를 군집에 재할당(배정)하기

step 3에서 했던 방법과 똑같이 시행하며, 더 이상 중심점의 이동이 없을 때까지 step 4와 step 5를 반복한다.



### 예제로 확인하기 

<img src="https://user-images.githubusercontent.com/68331041/146633489-fc90e838-a8c9-4b0f-8da1-6678a6263e17.png" alt="image" style="zoom:25%;" />

다음과 같은 6개의 데이터가 있다. 군집의 개수(K) = 3 으로 설정

<img src="https://user-images.githubusercontent.com/68331041/146633496-666f0372-2eae-4f3f-a968-a7a7d2466048.png" alt="image" style="zoom:25%;" />

초기 중심점을 설정한다. 

<img src="https://user-images.githubusercontent.com/68331041/146633504-cb4013a9-4a5b-4cdf-bf21-5e6e532e1b8e.png" alt="image" style="zoom:25%;" />

일반 적으로 유클리드 거리가 가장 가까운 데이터를 해당 군집으로 배정한다.

> 데이터1 은 C1 군집으로 배정된다.

나머지 데이터 2~6도 같은 방식으로 배정된다.

<img src="https://user-images.githubusercontent.com/68331041/146633516-64b6849c-a553-4e9d-8386-3a6bb0699b31.png" alt="image" style="zoom:25%;" />

중심점을 각 군집에 속하는 데이터들의 중간으로 재설정한다.

<img src="https://user-images.githubusercontent.com/68331041/146633521-b04ebc2a-997b-4d19-93c8-e570c2b14f7b.png" alt="image" style="zoom:25%;" />

중심점이 더 이상 변화하지 않을때까지 중심점 재설정과 재배정 과정을 반복해야 하지만 예제에서는 중심점이 더이상 변화하지 않기 때문에 클러스터링이 종료된다.

최종 군집화 결과이다.







## Reference

---

[머신러닝-k-means](https://velog.io/@jhlee508/%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D-K-%ED%8F%89%EA%B7%A0K-Means-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98)

https://www.youtube.com/watch?v=sXgQsJLDP8g